# پاسخ‌نامه مرجع فارسی (نسخه دقیق و کامل)

این سند مرجع رسمی تصحیح برای نسخه توسعه‌یافته تمرین نهایی است و باید همراه با خروجی‌های اجرایی پروژه بررسی شود.

## نحوه استفاده از این سند
- این فایل «پاسخ نهایی» نیست، بلکه «استاندارد ارزیابی پاسخ دانشجو» است.
- برای هر سؤال، 6 بخش آمده است:
  1. هدف سؤال
  2. انتظار پاسخ کامل
  3. پاسخ مرجع فنی
  4. خروجی‌های قابل تحویل
  5. خطاهای رایج
  6. معیار تصحیح (Rubric)
- در سؤالات محاسباتی، اگر منطق دانشجو درست باشد اما عدد نهایی کمی تفاوت داشته باشد، نمره جزئی محفوظ است.

---

## Q1) چرخه عمر علم داده و صورت‌بندی مسئله

### هدف سؤال
ارزیابی توان دانشجو در تبدیل «یک مسئله واقعی» به «مسئله قابل مدل‌سازی» با معیارهای روشن.

### انتظار پاسخ کامل
- تعریف دقیق مسئله تصمیمی
- تعریف خروجی مدل و مصرف‌کننده خروجی
- تعریف KPIهای فنی و کسب‌وکاری
- ریسک‌های کلیدی (leakage/drift/fairness)
- طرح استقرار و مانیتورینگ

### پاسخ مرجع فنی
- مسئله: پیش‌بینی `Migration_Status` برای پشتیبانی تصمیم‌یار (نه تصمیم‌گیر خودکار).
- KPI پایه: `ROC-AUC` (قدرت رتبه‌بندی)، `F1` (توازن precision/recall)، `Calibration` (قابلیت اعتماد احتمال).
- ریسک‌ها: نشت ویژگی‌های پس‌رخداد، تغییر توزیع زمانی، بایاس سیاستی، و ناهمخوانی train/serve.
- استقرار: مدل + پایش drift + بازبینی انسانی برای موارد حساس.

### خروجی‌های قابل تحویل
- یک متن صورت‌بندی دقیق در گزارش
- جدول KPIهای هدف
- فلوچارت چرخه عمر مدل

### خطاهای رایج
- تعریف مبهم هدف (مثلاً «مدل خوب بسازیم»)
- استفاده از Accuracy به‌عنوان تنها معیار
- بی‌توجهی به مسیر استقرار و نظارت

### معیار تصحیح
- 40% تعریف مسئله و هدف
- 30% معیارها و ریسک‌ها
- 30% طرح استقرار و عملیات

---

## Q2) عملیات داده و EDA

### هدف سؤال
ارزیابی مهارت حسابرسی داده قبل از مدل‌سازی.

### انتظار پاسخ کامل
- بررسی schema (`dtype`, missing, duplicates)
- تحلیل توصیفی هدفمند (نه صرفاً نمودار زیاد)
- شناسایی داده پرت/ناسازگار
- طراحی preprocessing قابل تکرار

### پاسخ مرجع فنی
حداقل باید این موارد وجود داشته باشد:
- توزیع کلاس هدف
- پروفایل missingness
- هم‌بستگی ویژگی‌های عددی
- نرخ مهاجرت در گروه‌های اصلی (مثلاً کشور)
- گزارش کیفیت داده قبل از هر مدل

### خروجی‌های قابل تحویل
- چند نمودار قابل استناد
- جدول کیفیت داده
- یک تابع preprocessing تکرارپذیر

### خطاهای رایج
- نمودارهای بدون تفسیر
- حذف کورکورانه missingها
- عدم ثبت تصمیم‌های پاک‌سازی

### معیار تصحیح
- 35% حسابرسی داده
- 35% کیفیت تحلیل EDA
- 30% قابلیت بازتولید preprocessing

---

## Q3) استنباط آماری

### هدف سؤال
تسلط بر منطق آزمون فرض و تفسیر درست p-value/CI.

### انتظار پاسخ کامل
- تعریف `H0` و `H1`
- انتخاب آزمون متناسب با نوع داده
- بررسی مفروضات آزمون
- تفسیر آماری دقیق

### پاسخ مرجع فنی
- p-value «احتمال درست بودن H0» نیست.
- اگر CI شامل صفر نباشد، اثر پارامتر معنادار است.
- دانشجو باید علاوه بر معناداری، اندازه اثر را نیز توضیح دهد.

### خروجی‌های قابل تحویل
- جدول آزمون‌ها
- تفسیر نتیجه با زبان تصمیم‌محور

### خطاهای رایج
- نتیجه‌گیری علی از داده مشاهده‌ای
- تفسیر غلط p-value

### معیار تصحیح
- 40% صحت فرمول‌بندی آماری
- 30% رعایت مفروضات
- 30% تفسیر کاربردی

---

## Q4) طراحی بصری و روایت داده

### هدف سؤال
ارزیابی توان انتقال پیام تحلیلی به مخاطب غیرتخصصی/تصمیم‌گیر.

### انتظار پاسخ کامل
- تعریف پیام هر نمودار
- انتخاب درست محور، مقیاس، رنگ، annotation
- نمایش یک نمونه نمودار گمراه‌کننده و اصلاح آن

### پاسخ مرجع فنی
نمودار خوب باید:
- پیام واحد داشته باشد
- خوانایی و مقایسه را تسهیل کند
- بدون اغراق بصری باشد

### خروجی‌های قابل تحویل
- داشبورد/نمودارهای داستان‌محور
- توضیح تصمیمی کنار هر نمودار

### خطاهای رایج
- تزئین بدون پیام
- محورهای برش‌خورده یا مقیاس گمراه‌کننده

### معیار تصحیح
- 50% کیفیت روایت
- 30% کیفیت طراحی بصری
- 20% صحت تفسیر

---

## Q5) SQL پیشرفته

### هدف سؤال
تسلط بر window functions و تحلیل cohort/sequence.

### انتظار پاسخ کامل
- کوئری moving average با window frame صحیح
- رتبه‌بندی درون گروهی
- حداقل یک CTE تحلیلی دیگر

### پاسخ مرجع فنی
```sql
WITH citation_velocity AS (
  SELECT UserID, Country_Origin, Year, Research_Citations,
         AVG(Research_Citations) OVER (
           PARTITION BY Country_Origin
           ORDER BY Year
           ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
         ) AS moving_avg_citations
  FROM Professionals_Data
)
SELECT *, DENSE_RANK() OVER (
  PARTITION BY Country_Origin ORDER BY moving_avg_citations DESC
) AS country_rank
FROM citation_velocity;
```

### خروجی‌های قابل تحویل
- SQL فایل‌محور: `code/solutions/q1_moving_average.sql`

### خطاهای رایج
- استفاده از `RANGE` به‌جای `ROWS` در سناریوی ردیفی
- رتبه‌بندی روی ستون اشتباه

### معیار تصحیح
- 60% درستی منطق SQL
- 20% خوانایی و ساختار
- 20% پوشش نیاز مسئله

---

## Q6) نشت داده و معماری داده بزرگ

### هدف سؤال
توانایی تشخیص feature leakage و طراحی معماری ایمن در زمان.

### انتظار پاسخ کامل
- طبقه‌بندی ویژگی‌های مشکوک به leakage
- توضیح point-in-time correctness
- معماری data pipeline با لایه‌های استاندارد

### پاسخ مرجع فنی
- `Visa_Approval_Date`: نشت مستقیم (بعد از رخداد هدف)
- `Last_Login_Region`: نشت زمانی بالقوه
- `Passport_Renewal_Status`: پراکسی زمانی بالقوه
- `Years_Since_Degree`: معمولاً امن اگر timestamp درست باشد

شاخص‌های تشخیصی اجرای فعلی:
- `corr(visa_present, target)=1.0`
- `P(Migration=1|visa_present)=1.0`
- `P(Migration=1|visa_absent)=0.0`

### خروجی‌های قابل تحویل
- گزارش leakage و تصمیم حذف ویژگی
- معماری Bronze/Silver/Gold + Feature Store

### خطاهای رایج
- اتکا به هم‌بستگی به‌جای منطق زمانی
- بی‌توجهی به train/serve skew

### معیار تصحیح
- 50% تشخیص leakage
- 30% معماری درست
- 20% استدلال زمان‌محور

---

## Q7) مدل خطی و Elastic Net

### هدف سؤال
درک ریاضی منظم‌سازی ترکیبی و تفسیر پارامترها.

### انتظار پاسخ کامل
- مشتق جمله خطا
- مشتق جمله L2
- زیرگرادیان جمله L1 در صفر
- تفسیر آماری خروجی رگرسیون

### پاسخ مرجع فنی
\[
J(\theta)=\frac{1}{2m}\sum_{i=1}^{m}(h_\theta(x^{(i)})-y^{(i)})^2 + \lambda_1\sum_j|\theta_j| + \frac{\lambda_2}{2}\sum_j\theta_j^2
\]
\[
\nabla_{\theta_j}J = \frac{1}{m}\sum_i(h_\theta(x^{(i)})-y^{(i)})x_j^{(i)} + \lambda_1\partial|\theta_j| + \lambda_2\theta_j
\]

برای `theta_j=0`:
\[
\partial|\theta_j|\in[-1,1]
\]

### خروجی‌های قابل تحویل
- derivation گام‌به‌گام
- تفسیر CI و p-value

### خطاهای رایج
- مشتق‌گیری نادرست L1 در صفر
- خلط «معناداری آماری» با «اهمیت عملی»

### معیار تصحیح
- 60% صحت ریاضی
- 40% تفسیر آماری

---

## Q8) بهینه‌سازی: SGD, Momentum, Adam

### هدف سؤال
فهم هندسه تابع هزینه در ravine و اثر بهینه‌سازها.

### انتظار پاسخ کامل
- توضیح نوسان SGD
- معادله Momentum و شهود فیزیکی
- تفاوت Adam با Momentum

### پاسخ مرجع فنی
\[
v_t = \beta v_{t-1} + \eta g_t, \quad \theta_{t+1}=\theta_t-v_t
\]

- Momentum میانگین‌گیری زمانی گرادیان انجام می‌دهد.
- Adam علاوه بر ممان اول، ممان دوم را هم لحاظ می‌کند و گام هر پارامتر را تطبیقی تنظیم می‌کند.

### خروجی‌های قابل تحویل
- نمودار مسیر همگرایی: `code/figures/q3_ravine_optimizers.png`

### خطاهای رایج
- بیان کیفی بدون معادله
- عدم ارتباط با مسئله بدشرط

### معیار تصحیح
- 40% فرمول
- 40% شهود هندسی
- 20% تفسیر نمودار

---

## Q9) مدل‌های غیرخطی: SVM/Tree

### هدف سؤال
مدیریت trade-off بایاس/واریانس در مدل‌های غیرخطی.

### انتظار پاسخ کامل
- توضیح اثر `gamma` در RBF
- توضیح اثر `alpha` در pruning
- تحلیل نتیجه sweep

### پاسخ مرجع فنی
- در overfit، `gamma` باید کاهش یابد.
- در pruning:
\[
R_\alpha(T)=R(T)+\alpha|T|
\]
افزایش `alpha` => ساده‌سازی مدل و کاهش variance.

### خروجی‌های قابل تحویل
- `code/figures/q4_svm_gamma_sweep.png`
- `code/figures/q4_tree_pruning_curve.png`

### خطاهای رایج
- تفسیر معکوس gamma
- انتخاب hyperparameter فقط بر مبنای train

### معیار تصحیح
- 35% SVM
- 35% pruning
- 30% تفسیر تجربی

---

## Q10) PCA

### هدف سؤال
درک واریانس توضیح‌داده‌شده و معنای eigenvalue.

### انتظار پاسخ کامل
- تعریف EVR
- محاسبه EVR برای PC1/PC2
- تفسیر عملی مؤلفه‌ها

### پاسخ مرجع فنی
اگر `lambda1, lambda2, lambda3` مقادیر ویژه باشند:
- `EVR_k = lambda_k / (lambda1+lambda2+lambda3)`
- `EVR_1+2 = (lambda1+lambda2)/sum(lambda)`

### خروجی‌های قابل تحویل
- جدول EVR
- تفسیر انتخاب تعداد مؤلفه

### خطاهای رایج
- خلط eigenvector و eigenvalue

### معیار تصحیح
- 60% محاسبه
- 40% تفسیر

---

## Q11) KMeans و Elbow

### هدف سؤال
توجیه انتخاب `K` با استدلال هندسی و آماری.

### انتظار پاسخ کامل
- تعریف WCSS
- دلیل کاهش یکنواخت WCSS با K
- توضیح بازده نزولی و نقطه elbow

### پاسخ مرجع فنی
Elbow یک heuristic است: نقطه‌ای که افزایش K سود حاشیه‌ای ناچیز ایجاد می‌کند.

### خروجی‌های قابل تحویل
- نمودار elbow: `code/figures/q5_kmeans_elbow.png`

### خطاهای رایج
- انتخاب K صرفاً با چشم بدون تفسیر

### معیار تصحیح
- 40% منطق نظری
- 60% تحلیل خروجی واقعی

---

## Q12) شبکه‌های عصبی

### هدف سؤال
طراحی و ارزیابی یک baseline عصبی معتبر.

### انتظار پاسخ کامل
- تعریف معماری
- loss/optimizer/regularization
- کنترل overfitting
- مقایسه با baseline کلاسیک

### پاسخ مرجع فنی
مدل عصبی باید به‌عنوان مقایسه منصفانه گزارش شود، نه صرفاً «چون مدرن است». معیار ارزیابی باید با سایر مدل‌ها یکسان باشد.

### خروجی‌های قابل تحویل
- لاگ آموزش
- نمودار train/validation

### خطاهای رایج
- گزارش فقط accuracy
- عدم کنترل seed و reproducibility

### معیار تصحیح
- 30% طراحی مدل
- 40% ارزیابی
- 30% تحلیل خطا

---

## Q13) عامل LLM

### هدف سؤال
درک طراحی agentic workflow امن و قابل ارزیابی.

### انتظار پاسخ کامل
- pipeline: plan -> retrieve -> reason -> verify
- سیاست ایمنی و fallback
- سنجه faithfulness/hallucination

### پاسخ مرجع فنی
عامل باید deterministic gating برای ابزارها داشته باشد و مسیر fail-safe مشخص کند.

### خروجی‌های قابل تحویل
- دیاگرام جریان agent
- معیارهای کیفیت پاسخ

### خطاهای رایج
- طراحی مبهم بدون معیار

### معیار تصحیح
- 40% معماری عامل
- 30% ارزیابی
- 30% ایمنی و governance

---

## Q14) اخلاق، عدالت و حاکمیت

### هدف سؤال
افزودن لایه Responsible AI به چرخه مدل.

### انتظار پاسخ کامل
- تحلیل زیرگروهی متریک‌ها
- شناسایی proxy bias
- human-in-the-loop policy
- مسیر اعتراض/بازبینی

### پاسخ مرجع فنی
مدل باید «تصمیم‌یار» باشد، نه «قاضی نهایی». برای موارد حساس، بازبینی انسانی الزامی است.

### خروجی‌های قابل تحویل
- جدول fairness slices
- policy note

### خطاهای رایج
- تقلیل عدالت به یک متریک منفرد

### معیار تصحیح
- 40% تحلیل متریک
- 30% سیاست‌گذاری
- 30% تحلیل ریسک

---

## Q15) کالیبراسیون و سیاست آستانه

### هدف سؤال
تبدیل نمره مدل به احتمال قابل اتکا برای تصمیم عملیاتی.

### انتظار پاسخ کامل
- reliability curve
- Brier و ECE
- استخراج دو آستانه (F1-optimal و cost-optimal)

### پاسخ مرجع فنی
- انتخاب آستانه نباید پیش‌فرض 0.5 باشد.
- آستانه نهایی تابع ماتریس هزینه تصمیم است.

### خروجی‌های قابل تحویل
- `code/figures/q15_calibration_curve.png`
- `code/figures/q15_threshold_tradeoff.png`

### خطاهای رایج
- گزارش calibration بدون تفسیر تصمیمی

### معیار تصحیح
- 40% درستی متریک
- 30% سیاست آستانه
- 30% تفسیر کاربردی

---

## Q16) Drift Monitoring

### هدف سؤال
تشخیص جابه‌جایی توزیع داده بین مرجع و جاری.

### انتظار پاسخ کامل
- تعریف split مرجع/جاری
- PSI برای عددی‌ها
- شاخص drift برای دسته‌ای‌ها (مثل JS)
- قواعد هشدار و بازآموزی

### پاسخ مرجع فنی
تفسیر پیشنهادی PSI:
- `<0.10`: کم
- `0.10-0.25`: متوسط
- `>=0.25`: زیاد

### خروجی‌های قابل تحویل
- `code/solutions/q16_drift_psi.csv`
- `code/figures/q16_drift_psi_top12.png`

### خطاهای رایج
- استفاده از drift بدون پیشنهاد action plan

### معیار تصحیح
- 40% سنجش drift
- 30% تحلیل
- 30% سیاست عملیاتی

---

## Q17) Counterfactual Recourse

### هدف سؤال
ارزیابی «قابلیت اقدام» برای تغییر تصمیم مدل.

### انتظار پاسخ کامل
- تعریف ویژگی‌های actionable
- محاسبه حداقل تغییر لازم
- نرخ موفقیت recourse
- تحلیل امکان‌پذیری دنیای واقعی

### پاسخ مرجع فنی
recourse صرفاً عددی کافی نیست؛ باید از نظر هزینه/اخلاق/امکان اجرا تحلیل شود.

### خروجی‌های قابل تحویل
- `code/solutions/q17_recourse_examples.csv`
- `code/figures/q17_recourse_median_deltas.png`

### خطاهای رایج
- پیشنهاد تغییر روی ویژگی غیرقابل کنترل

### معیار تصحیح
- 40% محاسبات
- 30% واقع‌گرایی
- 30% تحلیل اخلاقی

---

## Q18) اعتبارسنجی زمانی و افت عملکرد

### هدف سؤال
بررسی پایداری مدل در پنجره‌های زمانی متوالی.

### انتظار پاسخ کامل
- rolling validation
- گزارش fold-wise AUC/F1
- گزارش decay نسبت به fold اول
- اعلام fallback در نبود زمان معتبر

### پاسخ مرجع فنی
اگر ستون زمانی معتبر نباشد، باید fallback صریحاً مستند شود (مثلاً `UserID` به‌عنوان proxy).

### خروجی‌های قابل تحویل
- `code/solutions/q18_temporal_backtest.csv`
- `code/figures/q18_temporal_degradation.png`

### خطاهای رایج
- استفاده از random split و نام‌گذاری آن به‌عنوان temporal

### معیار تصحیح
- 40% روش تقسیم زمانی
- 30% متریک‌ها
- 30% تحلیل افت/ریسک

---

## Q19) کمی‌سازی عدم‌قطعیت

### هدف سؤال
اندازه‌گیری اطمینان پیش‌بینی و کنترل under-coverage.

### انتظار پاسخ کامل
- روش conformal یا معادل معتبر
- coverage در سطوح مختلف confidence
- تحلیل عرض بازه
- policy برای low-confidence cases

### پاسخ مرجع فنی
کیفیت uncertainty خوب یعنی پوشش تجربی نزدیک سطح هدف و under-coverage کنترل‌شده.

### خروجی‌های قابل تحویل
- `code/solutions/q19_uncertainty_coverage.csv`
- `code/figures/q19_coverage_vs_alpha.png`

### خطاهای رایج
- گزارش coverage بدون مقایسه با target coverage

### معیار تصحیح
- 35% درستی روش
- 35% کیفیت تحلیل
- 30% تصمیم‌پذیری خروجی

---

## Q20) مداخله عدالت الگوریتمی

### هدف سؤال
بهبود fairness بدون تخریب غیرقابل‌قبول عملکرد.

### انتظار پاسخ کامل
- baseline fairness metrics
- اجرای mitigation
- مقایسه pre/post
- policy gate صریح برای پذیرش/رد

### پاسخ مرجع فنی
تحلیل باید هم‌زمان دو محور را نشان دهد:
- عدالت (gapها)
- کارایی (AUC/F1)

قبولی مداخله مشروط به عبور از قید سیاستی است.

### خروجی‌های قابل تحویل
- `code/solutions/q20_fairness_mitigation_comparison.csv`
- `code/figures/q20_fairness_tradeoff.png`

### خطاهای رایج
- بهبود یک متریک عدالت با افت شدید عملکرد

### معیار تصحیح
- 40% صحت مقایسه pre/post
- 30% رعایت قید سیاستی
- 30% تفسیر تصمیمی

---

## Capstone: SHAP (جمع‌بندی تفسیری)

### هدف
توضیح چرایی پیش‌بینی برای یک فرد خاص و سطح کل مدل.

### پاسخ مرجع
- `base_value`: مقدار پایه مدل
- `output_value`: خروجی نمونه
- جمع SHAP = اختلاف base و output

### نکته مهم
SHAP «رفتار مدل» را توضیح می‌دهد، نه علیت سیستم واقعی را.

---

## خروجی‌های مرجع برای کنترل نهایی
- `code/solutions/q1_moving_average.sql`
- `code/solutions/run_summary.json`
- `code/solutions/complete_solution_key.md`
- `code/solutions/SOLUTION_KEY_FA.md`
- `code/solutions/q18_temporal_backtest.csv`
- `code/solutions/q19_uncertainty_coverage.csv`
- `code/solutions/q20_fairness_mitigation_comparison.csv`
- `code/figures/q18_temporal_degradation.png`
- `code/figures/q19_coverage_vs_alpha.png`
- `code/figures/q20_fairness_tradeoff.png`
- `code/latex/project_report_full_fa.pdf`

---

## یادداشت تصحیح برای دستیاران
- اگر دانشجو منطق صحیح و روش معتبر ارائه دهد، حتی با تفاوت عددی کوچک نمره فنی حفظ شود.
- پاسخ‌های صرفاً توصیفی (بدون روش/عدد/خروجی) نباید نمره کامل بگیرند.
- در سؤالات Q18 تا Q20، «کیفیت استدلال تصمیمی» به اندازه عدد نهایی اهمیت دارد.
